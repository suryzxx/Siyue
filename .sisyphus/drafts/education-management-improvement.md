# 草稿：教育管理系统完善计划

## 项目背景
用户有一个教育管理系统，需要完善三个模块：

### 当前状态分析：
1. **班级管理模块** (`ClassManagement.tsx`)
   - 已存在，有复杂的筛选逻辑
   - 有Excel导出功能（使用exceljs和file-saver）
   - 需要改进：老师筛选支持搜索和多选，Excel导出列拆分

2. **学生管理模块** (`StudentManagement.tsx`)
   - 已存在但字段不完整
   - 当前字段：学生ID、姓名、登录帐号、性别、所属班级、创建时间、更新时间
   - 缺少字段：出生年月、学号、评测等级、所属校区、学生状态、跟进状态
   - 缺少功能：完整的筛选、编辑、转班、操作记录、获取临时验证码、新生录入、导出

3. **订单管理模块** (`OrderManagement.tsx`)
   - 已存在但字段不完整
   - 当前字段：订单ID、学生账号、商品名称、所属班级、实付金额、支付状态、创建时间、支付时间
   - 缺少字段：订单编号、手机号、学号、班级、订单状态（待支付、已支付、已取消、已退款）、支付方式（微信支付、现金）、实付金额、原价金额、优惠金额、教辅费、课程费、购买节数
   - 缺少功能：完整的筛选、导出订单列表

### 技术要求：
- React + TypeScript + Vite
- 没有UI组件库，使用原生CSS
- 使用exceljs和file-saver进行Excel导出

## 初步发现

### 项目结构
- 使用React + TypeScript + Vite
- 依赖：exceljs@4.4.0, file-saver@2.0.5
- 没有UI组件库，使用原生CSS

### 现有类型定义（types.ts）
- `StudentProfile`: 现有学生类型，字段不完整
- `Order`: 现有订单类型，字段不完整
- `ClassInfo`: 班级信息类型
- `Teacher`: 老师类型

### 现有常量（constants.ts）
- `TEACHERS`: 老师数据数组
- `ADMIN_STUDENTS`: 学生数据数组  
- `ORDERS`: 订单数据数组
- `CAMPUSES`: 校区数组

## 详细发现（基于探索代理分析）

### 班级管理模块（ClassManagement.tsx）
**当前状态**：
- 功能完整，包含班级列表、详情、创建/编辑、批量导入、Excel导出
- 老师筛选使用MultiSelect组件，但只支持多选，不支持搜索
- Excel导出列包含"班层"和"上课时间"列，需要拆分

**需要改进**：
1. 老师筛选：支持输入搜索和多选
2. Excel导出：班层列拆分为"年级"和"班型"，上课时间列拆分为"开课日期"、"结课日期"、"讲次时间"

### 学生管理模块（StudentManagement.tsx）
**当前状态**：
- 基础功能：学生列表展示、姓名/账号筛选
- 字段不完整：只有7个字段
- 功能缺失：缺少CRUD操作、批量操作、详细筛选、数据导入导出

**需要新增字段**：
- 出生年月、学号、评测等级、所属校区
- 学生状态（在读学生、潜在学生、历史学生）
- 跟进状态（待跟进、跟进中、已邀约、已签约、退费&流失）

**需要新增功能**：
- 完整筛选：学生信息查询、校区、学生状态、跟进状态
- 操作：编辑、转班、操作记录、获取临时验证码
- 新生录入、导出

### 订单管理模块（OrderManagement.tsx）
**当前状态**：
- 基础功能：订单列表、简单筛选
- 字段不完整：只有8个字段
- 功能缺失：缺少Excel导出、详细筛选

**需要新增字段**：
- 订单编号、手机号、学号、班级
- 订单状态（待支付、已支付、已取消、已退款）
- 支付方式（微信支付、现金）
- 实付金额、原价金额、优惠金额、教辅费、课程费、购买节数

**需要新增功能**：
- 完整筛选
- 导出订单列表

## 技术架构确认
- **前端**：React 19.2.3 + TypeScript + Vite
- **样式**：Tailwind CSS（通过CDN引入）
- **Excel处理**：exceljs@4.4.0 + file-saver@2.0.5
- **无UI组件库**：使用原生CSS和自定义组件
- **数据**：目前使用本地mock数据（constants.ts）

## 测试基础设施评估

**检查结果**：
1. **package.json**：没有test脚本，只有dev、build、preview脚本
2. **测试配置文件**：没有jest.config、vitest.config等测试配置文件
3. **现有测试文件**：没有找到任何*.test.*、*.spec.*、test_*文件
4. **测试框架**：项目没有配置任何测试框架
5. **当前状态**：**没有测试基础设施**

**测试决策**：
- 项目目前没有测试框架配置
- 需要决定是否设置测试基础设施

## 待澄清问题

1. **数据来源**：这些模块的数据是来自API还是本地mock数据？（从代码看是本地mock）
2. **字段映射**：新字段在现有类型中如何定义？
3. **筛选组件**：是否需要创建通用的筛选组件？
4. **导出格式**：Excel导出的具体列格式要求？
5. **操作记录**：操作记录需要记录哪些信息？
6. **验证码**：获取临时验证码的具体流程？
7. **状态枚举**：学生状态、跟进状态、订单状态的具体枚举值？
8. **校区数据**：校区数据如何获取？是否与班级管理中的校区一致？
9. **测试策略**：是否需要设置测试基础设施？如果设置，使用什么框架？

## 需要用户确认的关键决策

### 测试策略决策
**项目目前没有测试基础设施。您希望如何设置？**

选项：
1. **设置测试基础设施**：安装测试框架（推荐使用Vitest，与Vite集成良好），创建测试配置文件，为关键功能编写测试
2. **暂不设置测试**：继续使用手动验证，在计划中设计详细的验证步骤
3. **后续再考虑**：先完成功能开发，测试基础设施留到后期

### 数据来源决策
**当前使用本地mock数据。您希望：**
1. **保持mock数据**：继续使用constants.ts中的mock数据
2. **准备API集成**：定义API接口类型，但暂时使用mock数据
3. **立即集成API**：需要提供API接口文档

### 通用组件决策
**是否需要创建通用筛选组件？**
1. **创建通用组件**：基于ClassManagement中的MultiSelect组件，创建可复用的筛选组件
2. **各模块独立实现**：每个模块独立实现自己的筛选逻辑
3. **部分通用**：创建一些通用的筛选组件（如多选下拉、日期范围等）

## 下一步计划

基于详细分析，我需要：
1. 等待用户确认关键决策
2. 制定详细的实施计划
3. 定义新的类型和常量
4. 规划实施顺序和依赖关系
5. 创建详细的工作计划